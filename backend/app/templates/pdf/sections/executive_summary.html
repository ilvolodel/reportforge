<!-- EXECUTIVE SUMMARY -->
<div class="executive-summary">
    <h2>Executive Summary</h2>
    
    {% if executive_summary %}
    
    <!-- Narrative Overview -->
    {% if executive_summary.overview_text %}
    <div class="mb-2">
        <p>{{ executive_summary.overview_text }}</p>
    </div>
    {% endif %}
    
    <!-- KPI Grid -->
    <div class="kpi-grid">
        <!-- Revenue -->
        <div class="kpi-card">
            <div class="kpi-label">Revenue</div>
            <div class="kpi-value positive">
                {% if executive_summary.revenue_current %}
                {{ "€{:,.0f}".format(executive_summary.revenue_current).replace(',', '.') }}
                {% else %}
                €0
                {% endif %}
            </div>
        </div>
        
        <!-- Saving -->
        <div class="kpi-card">
            <div class="kpi-label">Saving</div>
            <div class="kpi-value {% if executive_summary.saving_current and executive_summary.saving_current > 0 %}positive{% else %}negative{% endif %}">
                {% if executive_summary.saving_current %}
                {{ "€{:,.0f}".format(executive_summary.saving_current).replace(',', '.') }}
                {% else %}
                €0
                {% endif %}
            </div>
        </div>
        
        <!-- Total -->
        <div class="kpi-card">
            <div class="kpi-label">Total</div>
            <div class="kpi-value">
                {% if executive_summary.total_current %}
                {{ "€{:,.0f}".format(executive_summary.total_current).replace(',', '.') }}
                {% else %}
                €0
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Comparison Table: Current vs Forecast -->
    {% if executive_summary.show_forecast %}
    <table>
        <thead>
            <tr>
                <th>Metric</th>
                <th class="text-right">{{ executive_summary.year_current or 'Current' }}</th>
                <th class="text-right">{{ executive_summary.year_forecast or 'Forecast' }}</th>
                <th class="text-right">Variazione</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Revenue AI</td>
                <td class="text-right amount revenue">
                    {{ "€{:,.0f}".format(executive_summary.revenue_current or 0).replace(',', '.') }}
                </td>
                <td class="text-right amount revenue">
                    {{ "€{:,.0f}".format(executive_summary.revenue_forecast or 0).replace(',', '.') }}
                </td>
                <td class="text-right">
                    {% set delta = (executive_summary.revenue_forecast or 0) - (executive_summary.revenue_current or 0) %}
                    <span class="{% if delta > 0 %}text-success{% elif delta < 0 %}text-danger{% endif %}">
                        {{ "{:+,.0f}".format(delta).replace(',', '.') }}
                    </span>
                </td>
            </tr>
            <tr>
                <td>Saving AI</td>
                <td class="text-right amount">
                    {{ "€{:,.0f}".format(executive_summary.saving_current or 0).replace(',', '.') }}
                </td>
                <td class="text-right amount">
                    {{ "€{:,.0f}".format(executive_summary.saving_forecast or 0).replace(',', '.') }}
                </td>
                <td class="text-right">
                    {% set delta = (executive_summary.saving_forecast or 0) - (executive_summary.saving_current or 0) %}
                    <span class="{% if delta > 0 %}text-success{% elif delta < 0 %}text-danger{% endif %}">
                        {{ "{:+,.0f}".format(delta).replace(',', '.') }}
                    </span>
                </td>
            </tr>
            <tr class="table-header-secondary">
                <td><strong>TOTAL</strong></td>
                <td class="text-right amount">
                    <strong>{{ "€{:,.0f}".format(executive_summary.total_current or 0).replace(',', '.') }}</strong>
                </td>
                <td class="text-right amount">
                    <strong>{{ "€{:,.0f}".format(executive_summary.total_forecast or 0).replace(',', '.') }}</strong>
                </td>
                <td class="text-right">
                    {% set delta = (executive_summary.total_forecast or 0) - (executive_summary.total_current or 0) %}
                    <strong>
                        <span class="{% if delta > 0 %}text-success{% elif delta < 0 %}text-danger{% endif %}">
                            {{ "{:+,.0f}".format(delta).replace(',', '.') }}
                        </span>
                    </strong>
                </td>
            </tr>
        </tbody>
    </table>
    {% endif %}
    
    <!-- Benefits -->
    {% if executive_summary.benefits_list %}
    <div class="mb-2">
        <h4>Benefici Chiave</h4>
        <ul>
            {% for benefit in executive_summary.benefits_list %}
            <li>{{ benefit }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
    
    <!-- Stakeholders -->
    {% if executive_summary.stakeholders_list %}
    <div>
        <h4>Stakeholder Coinvolti</h4>
        <p class="text-muted">
            {{ executive_summary.stakeholders_list|join(', ') }}
        </p>
    </div>
    {% endif %}
    
    {% else %}
    <p class="text-muted">Nessun executive summary disponibile per questo report.</p>
    {% endif %}
</div>
